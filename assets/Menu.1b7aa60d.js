import{d as J,b as _,l as K,k as B,z as O,c as A,e as F,f as e,w as a,i as d,o as N,F as P,p as Q,u as R,A as f,B as v,j as s,n as W,y as X,E as U}from"./index.bc6e1629.js";const Y={class:"user-manage"},Z={class:"query-form"},ee=s("\u67E5\u8BE2"),ue=s("\u91CD\u7F6E"),le={class:"base-table"},ae={class:"action"},te=s("\u65B0\u589E"),oe=s("\u65B0\u589E"),ne=s("\u7F16\u8F91"),de=s("\u5220\u9664"),se=F("span",null,"\u4E0D\u9009\uFF0C\u5219\u76F4\u63A5\u521B\u5EFA\u4E00\u7EA7\u83DC\u5355",-1),re=s("\u83DC\u5355"),me=s("\u6309\u94AE"),pe=s("\u6B63\u5E38"),ie=s("\u505C\u7528"),_e={class:"dialog-footer"},ce=s("\u53D6 \u6D88"),fe=s("\u786E \u5B9A"),Ce=J({__name:"Menu",setup(ve){const p=_({menuState:1}),D=_([]),x=[{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName",width:150},{label:"\u56FE\u6807",prop:"icon"},{label:"\u83DC\u5355\u7C7B\u578B",prop:"menuType",formatter(o,u,n){return{1:"\u83DC\u5355",2:"\u6309\u94AE"}[n]}},{label:"\u6743\u9650\u6807\u8BC6",prop:"menuCode"},{label:"\u8DEF\u7531\u5730\u5740",prop:"path"},{label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{label:"\u83DC\u5355\u72B6\u6001",prop:"menuState",width:90,formatter(o,u,n){return{1:"\u6B63\u5E38",2:"\u505C\u7528"}[n]}},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",formatter(o,u,n){return W.formateDate(new Date(n))}}],i=_(!1),t=_({parentId:[null],menuType:1,menuState:1});let E="",I={menuName:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"},{min:2,max:10,message:"\u957F\u5EA6\u57282-8\u4E2A\u5B57\u7B26",trigger:"blur"}]};const y=_(),c=_();K(()=>{C()});const C=async()=>{try{let o=await B.getMenuList(p.value);D.value=o,O.emit("updateMenu",o)}catch(o){throw new Error(o)}},V=o=>{o&&o.resetFields()},h=(o,u)=>{i.value=!0,E="add",o==2&&u&&u.parentId&&(t.value.parentId=[...u.parentId,u._id].filter(n=>n))},M=o=>{i.value=!0,E="edit",X(()=>{t.value=o})},$=async o=>{await B.menuSubmit({_id:o,action:"delete"}),U.success("\u5220\u9664\u6210\u529F"),C()},z=()=>{c.value&&c.value.validate(async o=>{if(o){let u={...t.value,action:E};console.log({params:u}),await B.menuSubmit(u),i.value=!1,U.success("\u64CD\u4F5C\u6210\u529F"),V(c.value),C()}})},L=()=>{i.value=!1,V(c.value)};return(o,u)=>{const n=d("el-input"),r=d("el-form-item"),w=d("el-option"),q=d("el-select"),m=d("el-button"),g=d("el-form"),k=d("el-table-column"),j=d("el-table"),G=d("el-cascader"),b=d("el-radio"),S=d("el-radio-group"),H=d("el-dialog");return N(),A("div",Y,[F("div",Z,[e(g,{ref_key:"form",ref:y,inline:!0,model:p.value},{default:a(()=>[e(r,{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName"},{default:a(()=>[e(n,{modelValue:p.value.menuName,"onUpdate:modelValue":u[0]||(u[0]=l=>p.value.menuName=l),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u83DC\u5355\u72B6\u6001",prop:"menuState"},{default:a(()=>[e(q,{modelValue:p.value.menuState,"onUpdate:modelValue":u[1]||(u[1]=l=>p.value.menuState=l)},{default:a(()=>[e(w,{value:1,label:"\u6B63\u5E38"}),e(w,{value:2,label:"\u505C\u7528"})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(m,{type:"primary",onClick:C},{default:a(()=>[ee]),_:1}),e(m,{onClick:u[2]||(u[2]=l=>V(y.value))},{default:a(()=>[ue]),_:1})]),_:1})]),_:1},8,["model"])]),F("div",le,[F("div",ae,[e(m,{type:"primary",onClick:u[3]||(u[3]=l=>h(1))},{default:a(()=>[te]),_:1})]),e(j,{data:D.value,"row-key":"_id","tree-props":{children:"children"}},{default:a(()=>[(N(),A(P,null,Q(x,l=>e(k,{key:l.prop,prop:l.prop,label:l.label,width:l.width,formatter:l.formatter},null,8,["prop","label","width","formatter"])),64)),e(k,{label:"\u64CD\u4F5C",width:"220"},{default:a(l=>[e(m,{onClick:T=>h(2,l.row),type:"primary",size:"small"},{default:a(()=>[oe]),_:2},1032,["onClick"]),e(m,{onClick:T=>M(l.row),size:"small"},{default:a(()=>[ne]),_:2},1032,["onClick"]),e(m,{type:"danger",size:"small",onClick:T=>$(l.row._id)},{default:a(()=>[de]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e(H,{title:"\u7528\u6237\u65B0\u589E",modelValue:i.value,"onUpdate:modelValue":u[12]||(u[12]=l=>i.value=l)},{footer:a(()=>[F("span",_e,[e(m,{onClick:L},{default:a(()=>[ce]),_:1}),e(m,{type:"primary",onClick:z},{default:a(()=>[fe]),_:1})])]),default:a(()=>[e(g,{ref_key:"dialogForm",ref:c,model:t.value,"label-width":"100px",rules:R(I)},{default:a(()=>[e(r,{label:"\u7236\u7EA7\u83DC\u5355",prop:"parentId"},{default:a(()=>[e(G,{modelValue:t.value.parentId,"onUpdate:modelValue":u[4]||(u[4]=l=>t.value.parentId=l),options:D.value,props:{checkStrictly:!0,value:"_id",label:"menuName"},clearable:""},null,8,["modelValue","options"]),se]),_:1}),e(r,{label:"\u83DC\u5355\u7C7B\u578B",prop:"menuType"},{default:a(()=>[e(S,{modelValue:t.value.menuType,"onUpdate:modelValue":u[5]||(u[5]=l=>t.value.menuType=l)},{default:a(()=>[e(b,{label:1},{default:a(()=>[re]),_:1}),e(b,{label:2},{default:a(()=>[me]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName"},{default:a(()=>[e(n,{modelValue:t.value.menuName,"onUpdate:modelValue":u[6]||(u[6]=l=>t.value.menuName=l),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0"},null,8,["modelValue"])]),_:1}),f(e(r,{label:"\u83DC\u5355\u56FE\u6807",prop:"icon"},{default:a(()=>[e(n,{modelValue:t.value.icon,"onUpdate:modelValue":u[7]||(u[7]=l=>t.value.icon=l),placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D"},null,8,["modelValue"])]),_:1},512),[[v,t.value.menuType==1]]),f(e(r,{label:"\u8DEF\u7531\u5730\u5740",prop:"path"},{default:a(()=>[e(n,{modelValue:t.value.path,"onUpdate:modelValue":u[8]||(u[8]=l=>t.value.path=l),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740"},null,8,["modelValue"])]),_:1},512),[[v,t.value.menuType==1]]),f(e(r,{label:"\u6743\u9650\u6807\u8BC6",prop:"menuCode"},{default:a(()=>[e(n,{modelValue:t.value.menuCode,"onUpdate:modelValue":u[9]||(u[9]=l=>t.value.menuCode=l),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u6807\u8BC6"},null,8,["modelValue"])]),_:1},512),[[v,t.value.menuType==2]]),f(e(r,{label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{default:a(()=>[e(n,{modelValue:t.value.component,"onUpdate:modelValue":u[10]||(u[10]=l=>t.value.component=l),placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"])]),_:1},512),[[v,t.value.menuType==1]]),f(e(r,{label:"\u83DC\u5355\u72B6\u6001",prop:"menuState"},{default:a(()=>[e(S,{modelValue:t.value.menuState,"onUpdate:modelValue":u[11]||(u[11]=l=>t.value.menuState=l)},{default:a(()=>[e(b,{label:1},{default:a(()=>[pe]),_:1}),e(b,{label:2},{default:a(()=>[ie]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[v,t.value.menuType==1]])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Ce as default};
