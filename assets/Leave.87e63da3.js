import{_ as z,r as k,b as T,l as B,c as L,e as p,f as e,w as t,m as O,n as w,i,o as F,F as R,p as j,q as A,s as E,j as c,t as f}from"./index.bc6e1629.js";const I={name:"user",setup(){const{proxy:u}=O(),o=k({applyState:1}),b=k({pageNum:1,pageSize:10,total:0}),a=k([{label:"\u5355\u53F7",prop:"orderNo"},{label:"\u4F11\u5047\u65F6\u95F4",prop:"",formatter(n){return w.formateDate(new Date(n.startTime),"yyyy-MM-dd")+"\u5230"+w.formateDate(new Date(n.endTime),"yyyy-MM-dd")}},{label:"\u4F11\u5047\u65F6\u957F",prop:"leaveTime"},{label:"\u4F11\u5047\u7C7B\u578B",prop:"applyType",formatter(n,l,d){return{1:"\u4E8B\u5047",2:"\u8C03\u4F11",3:"\u5E74\u5047"}[d]}},{label:"\u4F11\u5047\u539F\u56E0",prop:"reasons"},{label:"\u7533\u8BF7\u65F6\u95F4",prop:"createTime",width:180,formatter:(n,l,d)=>w.formateDate(new Date(d))},{label:"\u5BA1\u6279\u4EBA",prop:"auditUsers"},{label:"\u5F53\u524D\u5BA1\u6279\u4EBA",prop:"curAuditUserName"},{label:"\u5BA1\u6279\u72B6\u6001",prop:"applyState",formatter:(n,l,d)=>({1:"\u5F85\u5BA1\u6279",2:"\u5BA1\u6279\u4E2D",3:"\u5BA1\u6279\u62D2\u7EDD",4:"\u5BA1\u6279\u901A\u8FC7",5:"\u4F5C\u5E9F"})[d]}]),S=T([]),_=k({applyType:1,startTime:"",endTime:"",leaveTime:"0\u5929",reasons:""}),s=T("create"),v=T(!1),r=T(!1);let m=T({});const h={startTime:[{type:"date",required:!0,message:"\u8BF7\u8F93\u5165\u5F00\u59CB\u65E5\u671F",trigger:"change"}],endTime:[{type:"date",required:!0,message:"\u8BF7\u8F93\u5165\u7ED3\u675F\u65E5\u671F",trigger:"change"}],reasons:[{required:!0,message:"\u8BF7\u8F93\u5165\u4F11\u5047\u539F\u56E0",trigger:["change","blur"]}]};B(()=>{y()});const y=async()=>{let n={...o,...b},{list:l,page:d}=await u.$api.getApplyList(n);S.value=l,b.total=d.total},C=n=>{u.$refs[n].resetFields()},q=n=>{b.pageNum=n,getUserList()},V=()=>{v.value=!0,s.value="create"},g=()=>{v.value=!1,C("dialogForm")};return{queryForm:o,pager:b,columns:a,handleCurrentChange:q,handleReset:C,getApplyList:y,applyList:S,leaveForm:_,showModal:v,showDetailModal:r,handleApply:V,handleClose:g,handleSubmit:()=>{u.$refs.dialogForm.validate(async n=>{if(n)try{let l={..._,action:s.value},d=await u.$api.leaveOperate(l);u.$message.success("\u521B\u5EFA\u6210\u529F"),g(),y()}catch{}})},rules:h,handleDateChange:(n,l)=>{let{startTime:d,endTime:N}=_;!d||!N||(d>N?(u.$message.error("\u5F00\u59CB\u65E5\u671F\u4E0D\u80FD\u665A\u4E8E\u7ED3\u675F\u65E5\u671F"),_.leaveTime="0\u5929",setTimeout(()=>{_[n]=""},0)):_.leaveTime=(N-d)/(24*60*60*1e3)+1+"\u5929")},detail:m,handleDetail:n=>{let l={...n};l.applyTypeName={1:"\u4E8B\u5047",2:"\u8C03\u4F11",3:"\u5E74\u5047"}[l.applyType],l.time=w.formateDate(new Date(l.startTime),"yyyy-MM-dd")+"\u5230"+w.formateDate(new Date(l.endTime),"yyyy-MM-dd"),l.applyStateName={1:"\u5F85\u5BA1\u6279",2:"\u5BA1\u6279\u4E2D",3:"\u5BA1\u6279\u62D2\u7EDD",4:"\u5BA1\u6279\u901A\u8FC7",5:"\u4F5C\u5E9F"}[l.applyState],m.value=l,r.value=!0},handleDelete:async n=>{try{let l={_id:n,action:"delete"},d=await u.$api.leaveOperate(l);u.$message.success("\u5220\u9664\u6210\u529F"),y()}catch{}}}}},G={class:"user-manage"},H={class:"query-form"},J=c("\u67E5\u8BE2"),K=c("\u91CD\u7F6E"),P={class:"base-table"},Q={class:"action"},W=c("\u7533\u8BF7\u4F11\u5047"),X=c("\u67E5\u770B"),Y=c("\u4F5C\u5E9F"),Z=c("-"),$={class:"dialog-footer"},ee=c("\u53D6 \u6D88"),le=c("\u786E \u5B9A");function ae(u,o,b,a,S,_){const s=i("el-option"),v=i("el-select"),r=i("el-form-item"),m=i("el-button"),h=i("el-form"),y=i("el-table-column"),C=i("el-table"),q=i("el-pagination"),V=i("el-date-picker"),g=i("el-col"),x=i("el-row"),U=i("el-input"),M=i("el-dialog"),D=i("el-step"),n=i("el-steps");return F(),L("div",G,[p("div",H,[e(h,{ref:"form",inline:!0,model:a.queryForm},{default:t(()=>[e(r,{label:"\u5BA1\u6279\u72B6\u6001",prop:"applyState"},{default:t(()=>[e(v,{modelValue:a.queryForm.applyState,"onUpdate:modelValue":o[0]||(o[0]=l=>a.queryForm.applyState=l)},{default:t(()=>[e(s,{value:"",label:"\u5168\u90E8"}),e(s,{value:1,label:"\u5F85\u5BA1\u6279"}),e(s,{value:2,label:"\u5BA1\u6279\u4E2D"}),e(s,{value:3,label:"\u5BA1\u6279\u62D2\u7EDD"}),e(s,{value:4,label:"\u5BA1\u6279\u901A\u8FC7"}),e(s,{value:5,label:"\u4F5C\u5E9F"})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[e(m,{type:"primary",onClick:a.getApplyList},{default:t(()=>[J]),_:1},8,["onClick"]),e(m,{onClick:o[1]||(o[1]=l=>a.handleReset("form"))},{default:t(()=>[K]),_:1})]),_:1})]),_:1},8,["model"])]),p("div",P,[p("div",Q,[e(m,{type:"primary",onClick:a.handleApply},{default:t(()=>[W]),_:1},8,["onClick"])]),e(C,{data:a.applyList},{default:t(()=>[(F(!0),L(R,null,j(a.columns,l=>(F(),A(y,{key:l.prop,prop:l.prop,label:l.label,width:l.width,formatter:l.formatter},null,8,["prop","label","width","formatter"]))),128)),e(y,{label:"\u64CD\u4F5C",width:"150"},{default:t(l=>[e(m,{size:"mini",onClick:d=>a.handleDetail(l.row)},{default:t(()=>[X]),_:2},1032,["onClick"]),[1,2].includes(l.row.applyState)?(F(),A(m,{key:0,type:"danger",size:"mini",onClick:d=>a.handleDelete(l.row._id)},{default:t(()=>[Y]),_:2},1032,["onClick"])):E("",!0)]),_:1})]),_:1},8,["data"]),e(q,{class:"pagination",background:"",layout:"prev, pager, next",total:a.pager.total,"page-size":a.pager.pageSize,onCurrentChange:a.handleCurrentChange},null,8,["total","page-size","onCurrentChange"])]),e(M,{title:"\u7533\u8BF7\u4F11\u5047",modelValue:a.showModal,"onUpdate:modelValue":o[8]||(o[8]=l=>a.showModal=l),width:"70%"},{footer:t(()=>[p("span",$,[e(m,{onClick:a.handleClose},{default:t(()=>[ee]),_:1},8,["onClick"]),e(m,{type:"primary",onClick:a.handleSubmit},{default:t(()=>[le]),_:1},8,["onClick"])])]),default:t(()=>[e(h,{ref:"dialogForm",model:a.leaveForm,"label-width":"120px",rules:a.rules},{default:t(()=>[e(r,{label:"\u4F11\u5047\u7C7B\u578B",prop:"applyType",required:""},{default:t(()=>[e(v,{modelValue:a.leaveForm.applyType,"onUpdate:modelValue":o[2]||(o[2]=l=>a.leaveForm.applyType=l)},{default:t(()=>[e(s,{label:"\u4E8B\u5047",value:1}),e(s,{label:"\u8C03\u4F11",value:2}),e(s,{label:"\u5E74\u5047",value:3})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"\u4F11\u5047\u7C7B\u578B",required:""},{default:t(()=>[e(x,null,{default:t(()=>[e(g,{span:8},{default:t(()=>[e(r,{prop:"startTime",required:""},{default:t(()=>[e(V,{modelValue:a.leaveForm.startTime,"onUpdate:modelValue":o[3]||(o[3]=l=>a.leaveForm.startTime=l),type:"date",placeholder:"\u9009\u62E9\u5F00\u59CB\u65E5\u671F",onChange:o[4]||(o[4]=l=>a.handleDateChange("startTime",l))},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:1},{default:t(()=>[Z]),_:1}),e(g,{span:8},{default:t(()=>[e(r,{prop:"endTime",required:""},{default:t(()=>[e(V,{modelValue:a.leaveForm.endTime,"onUpdate:modelValue":o[5]||(o[5]=l=>a.leaveForm.endTime=l),type:"date",placeholder:"\u9009\u62E9\u7ED3\u675F\u65E5\u671F",onChange:o[6]||(o[6]=l=>a.handleDateChange("endTime",l))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{label:"\u4F11\u5047\u65F6\u957F",required:""},{default:t(()=>[c(f(a.leaveForm.leaveTime),1)]),_:1}),e(r,{label:"\u4F11\u5047\u539F\u56E0",prop:"reasons",required:""},{default:t(()=>[e(U,{type:"textarea",row:3,placeholder:"\u8BF7\u8F93\u5165\u4F11\u5047\u539F\u56E0",modelValue:a.leaveForm.reasons,"onUpdate:modelValue":o[7]||(o[7]=l=>a.leaveForm.reasons=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(M,{title:"\u7533\u8BF7\u4F11\u5047\u8BE6\u60C5",width:"50%",modelValue:a.showDetailModal,"onUpdate:modelValue":o[9]||(o[9]=l=>a.showDetailModal=l),"destroy-on-close":""},{default:t(()=>[e(n,{active:a.detail.applyState>2?3:a.detail.applyState,"align-center":""},{default:t(()=>[e(D,{title:"\u5F85\u5BA1\u6279"}),e(D,{title:"\u5BA1\u6279\u4E2D"}),e(D,{title:"\u5BA1\u6279\u901A\u8FC7/\u5BA1\u6279\u62D2\u7EDD"})]),_:1},8,["active"]),e(h,{"label-width":"120px","label-suffix":":"},{default:t(()=>[e(r,{label:"\u4F11\u5047\u7C7B\u578B"},{default:t(()=>[p("div",null,f(a.detail.applyTypeName),1)]),_:1}),e(r,{label:"\u4F11\u5047\u65F6\u95F4"},{default:t(()=>[p("div",null,f(a.detail.time),1)]),_:1}),e(r,{label:"\u4F11\u5047\u65F6\u957F"},{default:t(()=>[p("div",null,f(a.detail.leaveTime),1)]),_:1}),e(r,{label:"\u4F11\u5047\u539F\u56E0"},{default:t(()=>[p("div",null,f(a.detail.reasons),1)]),_:1}),e(r,{label:"\u5BA1\u6279\u72B6\u6001"},{default:t(()=>[p("div",null,f(a.detail.applyStateName),1)]),_:1}),e(r,{label:"\u5BA1\u6279\u4EBA"},{default:t(()=>[p("div",null,f(a.detail.curAuditUserName),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var oe=z(I,[["render",ae]]);export{oe as default};
